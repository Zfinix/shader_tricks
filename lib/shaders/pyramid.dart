import 'dart:convert';
import 'dart:typed_data';

import 'dart:ui';

import 'package:umbra_flutter/umbra_flutter.dart';

/// {@template pyramid}
/// A Dart Shader class for the `pyramid` shader.
/// {@endtemplate}
class Pyramid extends UmbraShader {
  Pyramid._() : super(_cachedProgram!);

  /// {@macro pyramid}
  static Future<Pyramid> compile() async {
    try {
      // Caching the program on the first compile call.
      _cachedProgram ??= await FragmentProgram.compile(
        spirv: Uint8List.fromList(base64Decode(_spirv)).buffer,
      );

      return Pyramid._();
    } on Exception catch (err, stackTrace) {
      throw UmbraException(err, stackTrace);
    }
  }

  static FragmentProgram? _cachedProgram;

  Shader shader({
    required Size resolution,
    required double iTime,
  }) {
    return program.shader(
      floatUniforms: Float32List.fromList([
        iTime,
        resolution.width,
        resolution.height,
      ]),
      samplerUniforms: [],
    );
  }
}

const _spirv =
    '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';
